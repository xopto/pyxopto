

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Detectors &mdash; PyXOpto 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Surface layouts" href="surface_layout.html" />
    <link rel="prev" title="Sources" href="source.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> PyXOpto
          

          
            
            <img src="../../_static/xopto_logo_dark.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../opencl_devices.html">OpenCL devices</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Layered MC</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="layer_stack.html">The layer stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="phase_function.html">Scattering phase functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="source.html">Sources</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Detectors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#radial">Radial</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cartesian">Cartesian</a></li>
<li class="toctree-l3"><a class="reference internal" href="#total">Total</a></li>
<li class="toctree-l3"><a class="reference internal" href="#symmetric">Symmetric</a></li>
<li class="toctree-l3"><a class="reference internal" href="#probe">Probe</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-in-monte-carlo-simulator">Use in Monte Carlo simulator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="surface_layout.html">Surface layouts</a></li>
<li class="toctree-l2"><a class="reference internal" href="fluence.html">Fluence</a></li>
<li class="toctree-l2"><a class="reference internal" href="trace.html">Trace</a></li>
<li class="toctree-l2"><a class="reference internal" href="sampling_volume.html">Sampling volume</a></li>
<li class="toctree-l2"><a class="reference internal" href="simulator_data_types.html">Simulator data types</a></li>
<li class="toctree-l2"><a class="reference internal" href="simulator_options.html">Simulator options</a></li>
<li class="toctree-l2"><a class="reference internal" href="opencl_build_options.html">OpenCL build options</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/index.html">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../mccyl/index.html">Cylindrical MC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mcvox/index.html">Voxelized MC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataset/index.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/modules.html">xopto</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PyXOpto</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Layered MC</a> &raquo;</li>
        
      <li>Detectors</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="detectors">
<span id="mcml-detector-label"></span><h1>Detectors<a class="headerlink" href="#detectors" title="Permalink to this headline">¶</a></h1>
<p>Detectors are used to collect the weights of photon packets that escape the
sample at the top or bottom sample surface or to collect the weight of photon
packets that is specularly reflected when launching with the selected source.
The three detector locations can be populated and passed to the Monte Carlo
simulator through the <a class="reference internal" href="../../apidoc/xopto.mcml.mcdetector.base.html#xopto.mcml.mcdetector.base.Detectors" title="xopto.mcml.mcdetector.base.Detectors"><code class="xref py py-class docutils literal notranslate"><span class="pre">xopto.mcml.mcdetector.base.Detectors</span></code></a>.
All the detector types that can be used in the Monte Carlo simulator
are implemented by subclassing <a class="reference internal" href="../../apidoc/xopto.mcml.mcdetector.base.html#xopto.mcml.mcdetector.base.Detector" title="xopto.mcml.mcdetector.base.Detector"><code class="xref py py-class docutils literal notranslate"><span class="pre">xopto.mcml.mcdetector.base.Detector</span></code></a>.
The <a class="reference internal" href="../../apidoc/xopto.mcml.mcdetector.html#module-xopto.mcml.mcdetector" title="xopto.mcml.mcdetector"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xopto.mcml.mcdetector</span></code></a> module includes a number different detectors:</p>
<ul>
<li><p><a class="reference internal" href="../../apidoc/xopto.mcml.mcdetector.total.html#xopto.mcml.mcdetector.total.Total" title="xopto.mcml.mcdetector.total.Total"><code class="xref py py-class docutils literal notranslate"><span class="pre">xopto.mcml.mcdetector.total.Total</span></code></a> implements a
detector that collects the weight of photon packets into a single accumulator.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">xopto.mcml.mcsdetector.radial.Radial</span></code> implements a radial detector
that collects the photon packets through concentric annular rings.</p></li>
<li><p><a class="reference internal" href="../../apidoc/xopto.mcml.mcdetector.cartesian.html#xopto.mcml.mcdetector.cartesian.Cartesian" title="xopto.mcml.mcdetector.cartesian.Cartesian"><code class="xref py py-class docutils literal notranslate"><span class="pre">xopto.mcml.mcdetector.cartesian.Cartesian</span></code></a> implements a
Cartesian detector that collects the photon packets through a grid of
rectangular detectors.</p></li>
<li><p><a class="reference internal" href="../../apidoc/xopto.mcml.mcdetector.symmetric.html#xopto.mcml.mcdetector.symmetric.SymmetricX" title="xopto.mcml.mcdetector.symmetric.SymmetricX"><code class="xref py py-class docutils literal notranslate"><span class="pre">xopto.mcml.mcdetector.symmetric.SymmetricX</span></code></a> implements a
Cartesian detector that is symmetric across the x axis (uses the absolute
value of y coordinate).</p></li>
<li><p><a class="reference internal" href="../../apidoc/xopto.mcml.mcdetector.probe.html#module-xopto.mcml.mcdetector.probe" title="xopto.mcml.mcdetector.probe"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xopto.mcml.mcdetector.probe</span></code></a> implements several several standard
and custom parameterized layouts of optical fibers in optical fiber probes.</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="../../apidoc/xopto.mcml.mcdetector.probe.sixaroundone.html#xopto.mcml.mcdetector.probe.sixaroundone.SixAroundOne" title="xopto.mcml.mcdetector.probe.sixaroundone.SixAroundOne"><code class="xref py py-class docutils literal notranslate"><span class="pre">xopto.mcml.mcdetector.probe.sixaroundone.SixAroundOne</span></code></a> implements
the common six-around-one layout of optical fibers.</p></li>
<li><p><a class="reference internal" href="../../apidoc/xopto.mcml.mcdetector.probe.lineararray.html#xopto.mcml.mcdetector.probe.lineararray.LinearArray" title="xopto.mcml.mcdetector.probe.lineararray.LinearArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">xopto.mcml.mcdetector.probe.lineararray.LinearArray</span></code></a> implements
a linear layout of optical fibers, assuming that all the fibers are equal.</p></li>
<li><p><a class="reference internal" href="../../apidoc/xopto.mcml.mcdetector.probe.fiberarray.html#xopto.mcml.mcdetector.probe.fiberarray.FiberArray" title="xopto.mcml.mcdetector.probe.fiberarray.FiberArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">xopto.mcml.mcdetector.probe.fiberarray.FiberArray</span></code></a> implements
a general layout of optical fibers, where each optical fiber can have
different properties.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<p>The individual detectors are conveniently imported into the
<a class="reference internal" href="../../apidoc/xopto.mcml.mc.html#module-xopto.mcml.mc" title="xopto.mcml.mc"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xopto.mcml.mc</span></code></a> and <a class="reference internal" href="../../apidoc/xopto.mcml.mcdetector.html#module-xopto.mcml.mcdetector" title="xopto.mcml.mcdetector"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xopto.mcml.mcdetector</span></code></a> modules.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The first and last accumulator of the detectors along each axis will also
collect/accumulate the weights of photon packets that exceed the lower
and upper limit of the corresponding axis.</p>
</div>
<div class="section" id="radial">
<h2>Radial<a class="headerlink" href="#radial" title="Permalink to this headline">¶</a></h2>
<p>The following example shows how to create a
<a class="reference internal" href="../../apidoc/xopto.mcml.mcdetector.radial.html#xopto.mcml.mcdetector.radial.Radial" title="xopto.mcml.mcdetector.radial.Radial"><code class="xref py py-class docutils literal notranslate"><span class="pre">Radial</span></code></a> detector centered at
<img class="math" src="../../_images/math/d4e15fcd7ca5f5bf43681bba3f96d0c4ff08733b.png" alt="(x,y)=(0,0)"/> that collects photon packets from <img class="math" src="../../_images/math/4e27605972c09946dc3b7a5a5bee503763285034.png" alt="r=0"/> mm
to <img class="math" src="../../_images/math/295a47841b61f8aef9a97c8714ad32f5ab4a8032.png" alt="r=1"/> mm through concentric annular rings of thickness
10 μm. Note that the distribution of detectors along the radial
direction is defined by <a class="reference internal" href="../../apidoc/xopto.mcbase.mcutil.axis.html#xopto.mcbase.mcutil.axis.Axis" title="xopto.mcbase.mcutil.axis.Axis"><code class="xref py py-class docutils literal notranslate"><span class="pre">Axis</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">xopto.mcml</span> <span class="kn">import</span> <span class="n">mc</span>

<span class="n">det</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">mcdetector</span><span class="o">.</span><span class="n">Radial</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">mcdetector</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0e-3</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
<p>To use a logarithmic spacing of annular rings, set the input parameter
<code class="code docutils literal notranslate"><span class="pre">logscale=True</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">xopto.mcml</span> <span class="kn">import</span> <span class="n">mc</span>

<span class="n">det</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">mcdetector</span><span class="o">.</span><span class="n">Radial</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">mcdetector</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0e-3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">logscale</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
<p>The acceptance cone of the detector can be limited by specifying the minimum
acceptance angle cosine. The angle is by default computed relative to the
top or bottom sample surface normal. This behavior can be customized by
setting the reference direction through the <code class="code docutils literal notranslate"><span class="pre">direction</span></code> input argument
to a custom unit-length vector.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The acceptance cone is applied after the photon packet leaves the sample and
is refracted into the surrounding medium.</p>
</div>
<p>The following example creates a radial detector that collects photon packets
within ±10 <sup>o</sup> of sample surface normal.</p>
<p>To use a logarithmic spacing of annular rings, set the input parameter
<code class="code docutils literal notranslate"><span class="pre">logscale=True</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">xopto.mcml</span> <span class="kn">import</span> <span class="n">mc</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">cosmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="mf">10.0</span><span class="p">))</span>
<span class="n">det</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">mcdetector</span><span class="o">.</span><span class="n">Radial</span><span class="p">(</span>
    <span class="n">mc</span><span class="o">.</span><span class="n">mcdetector</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0e-3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">logscale</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">cosmin</span><span class="o">=</span><span class="n">cosmin</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="cartesian">
<h2>Cartesian<a class="headerlink" href="#cartesian" title="Permalink to this headline">¶</a></h2>
<p>In the next example, we create a
<a class="reference internal" href="../../apidoc/xopto.mcml.mcdetector.cartesian.html#xopto.mcml.mcdetector.cartesian.Cartesian" title="xopto.mcml.mcdetector.cartesian.Cartesian"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cartesian</span></code></a> detector that collects
photon packets through a grid of rectangular accumulators that span
<img class="math" src="../../_images/math/92b4b754966e4a581f924d4bfd1b0db7ab47c886.png" alt="[-1, 1]"/> mm along the x axis and <img class="math" src="../../_images/math/54f2716950baa2559a9033b1172a4aa3e1344cdc.png" alt="[-2, 2]"/> mm along
the y axis. The size of the rectangular accumulators is
<img class="math" src="../../_images/math/c5d1d4828f6dd42446198dd7bb09bee7fc07bcdd.png" alt="(x,y)=(10,10)"/> μm. Note that parameters <code class="code docutils literal notranslate"><span class="pre">cosmin</span></code> and
<code class="code docutils literal notranslate"><span class="pre">direction</span></code> can be optionally used to limit the acceptance cone of the
detector.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">xopto.mcml</span> <span class="kn">import</span> <span class="n">mc</span>

<span class="n">det</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">mcdetector</span><span class="o">.</span><span class="n">Cartesian</span><span class="p">(</span>
    <span class="n">xaxis</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">mcdetector</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span>
    <span class="n">yaxis</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">mcdetector</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mi">400</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>If a Cartesian detector is created with a single axis, the axis configuration
is applied to the x and y axis.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">xopto.mcml</span> <span class="kn">import</span> <span class="n">mc</span>

<span class="n">det</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">mcdetector</span><span class="o">.</span><span class="n">Cartesian</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">mcdetector</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="total">
<h2>Total<a class="headerlink" href="#total" title="Permalink to this headline">¶</a></h2>
<p>To collect the weights of photon packets that leave the sample into a single
accumulator, use the <a class="reference internal" href="../../apidoc/xopto.mcml.mcdetector.total.html#xopto.mcml.mcdetector.total.Total" title="xopto.mcml.mcdetector.total.Total"><code class="xref py py-class docutils literal notranslate"><span class="pre">xopto.mcml.mcdetector.total.Total</span></code></a> detector.
Note that parameters <code class="code docutils literal notranslate"><span class="pre">cosmin</span></code> and <code class="code docutils literal notranslate"><span class="pre">direction</span></code> can be optionally
used to limit the acceptance cone of the detector.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">xopto.mcml</span> <span class="kn">import</span> <span class="n">mc</span>

<span class="n">det</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">mcdetector</span><span class="o">.</span><span class="n">Total</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="symmetric">
<h2>Symmetric<a class="headerlink" href="#symmetric" title="Permalink to this headline">¶</a></h2>
<p>To collect photon packets symmetrically across the x axis, regardless of the
y coordinate use the <a class="reference internal" href="../../apidoc/xopto.mcml.mcdetector.symmetric.html#xopto.mcml.mcdetector.symmetric.SymmetricX" title="xopto.mcml.mcdetector.symmetric.SymmetricX"><code class="xref py py-class docutils literal notranslate"><span class="pre">xopto.mcml.mcdetector.symmetric.SymmetricX</span></code></a>
detector. This type of a detector is useful for sources that are tilted along
the x axis and produce a reflectance or transmittance response that is
symmetric along the x axis and the location along the y axis is not important.
The distribution of accumulators is defined through
<a class="reference internal" href="../../apidoc/xopto.mcbase.mcutil.axis.html#xopto.mcbase.mcutil.axis.SymmetricAxis" title="xopto.mcbase.mcutil.axis.SymmetricAxis"><code class="xref py py-class docutils literal notranslate"><span class="pre">xopto.mcbase.mcutil.axis.SymmetricAxis</span></code></a> that also supports logarithmic
spacing of the accumulators. Note that parameters <code class="code docutils literal notranslate"><span class="pre">cosmin</span></code> and
<code class="code docutils literal notranslate"><span class="pre">direction</span></code> can be optionally used to limit the acceptance cone of the
detector.
In the following example we create an instance of
<a class="reference internal" href="../../apidoc/xopto.mcml.mcdetector.symmetric.html#xopto.mcml.mcdetector.symmetric.SymmetricX" title="xopto.mcml.mcdetector.symmetric.SymmetricX"><code class="xref py py-class docutils literal notranslate"><span class="pre">SymmetricX</span></code></a> detector that spans the
range <img class="math" src="../../_images/math/83378d2e27ea87922262f7c507f413167baf6411.png" alt="[-10,10]"/> mm along the axis with the accumulator size along
the set to 10 μm.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">xopto.mcml</span> <span class="kn">import</span> <span class="n">mc</span>

<span class="n">det</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">mcdetector</span><span class="o">.</span><span class="n">SymmetricX</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">mcdetector</span><span class="o">.</span><span class="n">SymmetricAxis</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="probe">
<h2>Probe<a class="headerlink" href="#probe" title="Permalink to this headline">¶</a></h2>
<p>Probe detectors that utilize various layouts of optical fibers are intended for
use with complex surface layouts that break the radial symmetry of the
reflectance / transmittance at the sample surface. Consequently,
the <a class="reference internal" href="../../apidoc/xopto.mcml.mcdetector.radial.html#xopto.mcml.mcdetector.radial.Radial" title="xopto.mcml.mcdetector.radial.Radial"><code class="xref py py-class docutils literal notranslate"><span class="pre">Radial</span></code></a> detector cannot be used to
derive the reflectance collected through the individual fibers.</p>
<p>In the following example we create a six-around-one layout of optical fibers.
All the optical fibers have a fused silica core with a 400 μm diameter,
cladding diameter 420 μm, <img class="math" src="../../_images/math/d4845c0658a4d9a0f42cf3e23d4ccf22b7042fdb.png" alt="NA"/> 0.22 and are tightly
packed, i.e. the distance between the cores of the central and the surrounding
optical fibers is 420 μm. The refractive index of the fused silica is
taken from the <a class="reference internal" href="../../apidoc/xopto.materials.ri.html#module-xopto.materials.ri" title="xopto.materials.ri"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xopto.materials.ri</span></code></a> module.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">xopto.mcml</span> <span class="kn">import</span> <span class="n">mc</span>
<span class="kn">from</span> <span class="nn">xopto.mcml.mcutil</span> <span class="kn">import</span> <span class="n">fiber</span>
<span class="kn">from</span> <span class="nn">xopto.materials</span> <span class="kn">import</span> <span class="n">ri</span>

<span class="n">fib</span> <span class="o">=</span> <span class="n">fiber</span><span class="o">.</span><span class="n">MultimodeFiber</span><span class="p">(</span>
    <span class="mf">400e-6</span><span class="p">,</span>
    <span class="mf">420e-6</span><span class="p">,</span>
    <span class="n">ncore</span><span class="o">=</span><span class="n">ri</span><span class="o">.</span><span class="n">glass</span><span class="o">.</span><span class="n">fusedsilica</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="mf">550e-9</span><span class="p">),</span>
    <span class="n">na</span><span class="o">=</span><span class="mf">0.22</span>
<span class="p">)</span>
<span class="n">detector</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">mcdetector</span><span class="o">.</span><span class="n">SixAroundOne</span><span class="p">(</span><span class="n">fib</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that the geometry of the layout (<code class="code docutils literal notranslate"><span class="pre">spacing</span></code> of fibers) and the
properties of the optical fiber can be changed through accessing the related
class properties.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">detector</span><span class="o">.</span><span class="n">spacing</span> <span class="o">=</span> <span class="mf">800e-6</span>
<span class="n">detector</span><span class="o">.</span><span class="n">fiber</span><span class="o">.</span><span class="n">na</span> <span class="o">=</span> <span class="mf">0.23</span>
<span class="n">detector</span><span class="o">.</span><span class="n">fiber</span><span class="o">.</span><span class="n">dcore</span> <span class="o">=</span> <span class="mf">200e-6</span>
<span class="n">detector</span><span class="o">.</span><span class="n">fiber</span><span class="o">.</span><span class="n">dcladding</span> <span class="o">=</span> <span class="mf">220e-6</span>
<span class="n">detector</span><span class="o">.</span><span class="n">fiber</span><span class="o">.</span><span class="n">ncore</span> <span class="o">=</span> <span class="n">ri</span><span class="o">.</span><span class="n">glass</span><span class="o">.</span><span class="n">fusedsilica</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="mf">400e-9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="use-in-monte-carlo-simulator">
<h2>Use in Monte Carlo simulator<a class="headerlink" href="#use-in-monte-carlo-simulator" title="Permalink to this headline">¶</a></h2>
<p>To use the detectors in Monte Carlo simulations, we need to populate an instance
of <a class="reference internal" href="../../apidoc/xopto.mcml.mcdetector.base.html#xopto.mcml.mcdetector.base.Detectors" title="xopto.mcml.mcdetector.base.Detectors"><code class="xref py py-class docutils literal notranslate"><span class="pre">xopto.mcml.mcdetector.base.Detectors</span></code></a>, that can independently set
the detectors at the top and bottom sample surfaces and the detector for
photon packets that are specularly reflected at the medium-sample boundary
when launched. Note that it is not required to populate all the three detectors
(top, bottom and specular) as illustrated in this example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">xopto.mcml</span> <span class="kn">import</span> <span class="n">mc</span>

<span class="n">top</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">mcdetector</span><span class="o">.</span><span class="n">Radial</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">mcdetector</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="n">bottom</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">mcdetector</span><span class="o">.</span><span class="n">Cartesian</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">mcdetector</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
<span class="n">specular</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">mcdetector</span><span class="o">.</span><span class="n">Total</span><span class="p">()</span>

<span class="n">detectors</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">mcdetector</span><span class="o">.</span><span class="n">Detectors</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="n">top</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">bottom</span><span class="p">,</span> <span class="n">specular</span><span class="o">=</span><span class="n">specular</span><span class="p">)</span>
</pre></div>
</div>
<p>After completing the Monte Carlo simulations, the returned instance of
<a class="reference internal" href="../../apidoc/xopto.mcml.mcdetector.base.html#xopto.mcml.mcdetector.base.Detectors" title="xopto.mcml.mcdetector.base.Detectors"><code class="xref py py-class docutils literal notranslate"><span class="pre">Detectors</span></code></a> can be used to access the
collected reflectance (also used for transmittance) or the accumulated raw
weight of the photon packets. Note that the reflectance / transmittance is
computed as the raw weight in the accumulator divided by the number of
launched photon packets and if applicable also divided by the surface area of
the accumulator (weight/m <sup>2</sup>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">top_reflectance</span> <span class="o">=</span> <span class="n">detectors</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">reflectance</span>
<span class="n">top_raw</span> <span class="n">weight</span> <span class="o">=</span> <span class="n">detectors</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">raw</span>

<span class="n">bottom_reflectance</span> <span class="o">=</span> <span class="n">detectors</span><span class="o">.</span><span class="n">bottom</span><span class="o">.</span><span class="n">reflectance</span>
<span class="n">bottom_raw</span> <span class="n">weight</span> <span class="o">=</span> <span class="n">detectors</span><span class="o">.</span><span class="n">bottom</span><span class="o">.</span><span class="n">raw</span>

<span class="n">specular_reflectance</span> <span class="o">=</span> <span class="n">detectors</span><span class="o">.</span><span class="n">specular</span><span class="o">.</span><span class="n">reflectance</span>
<span class="n">specular_raw</span> <span class="n">weight</span> <span class="o">=</span> <span class="n">detectors</span><span class="o">.</span><span class="n">specular</span><span class="o">.</span><span class="n">raw</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="surface_layout.html" class="btn btn-neutral float-right" title="Surface layouts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="source.html" class="btn btn-neutral float-left" title="Sources" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, XOpto team.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>